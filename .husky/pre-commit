
#!/bin/sh

# Check if any ToS files are being modified (including domain-specific ones)
TOS_FILES=$(git diff --cached --name-only | grep "src/static-content/tos.*\.md")

if [ ! -z "$TOS_FILES" ]; then
  echo "ToS file(s) detected in commit, updating lastmod date..."

  # Update the lastmod field in frontmatter (format: YYYY-MM-DD)
  DATE=$(date +"%Y-%m-%d")

  # Process each ToS file
  for file in $TOS_FILES; do
    echo "Updating lastmod in: $file"
    sed -i.bak "s/^lastmod: .*/lastmod: $DATE/" "$file"
    rm -f "$file.bak"

    # Stage the updated file
    git add "$file"
  done

  echo "ToS lastmod updated to: $DATE"
fi

#branch="$(git rev-parse --abbrev-ref HEAD)"
#if [ "$branch" != "main" ]; then
#	exit 0
#fi

# NOTE: apparently tsc-files just doesn't work on windows. at all.

#echo "Running typecheck for staged files"
#
#npx lint-staged
#
#echo "Typecheck successful"
